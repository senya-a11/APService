<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- –ò–∫–æ–Ω–∫–∏ -->
    <link rel="apple-touch-icon" sizes="180x180" href="/static/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon/favicon-16x16.png">
    <link rel="icon" href="/static/favicon/favicon.ico" type="image/x-icon">
    <link rel="manifest" href="/static/favicon/site.webmanifest">

    <title>–ê–¥–º–∏–Ω–∫–∞ | Scooter Parts</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #6b7280;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --background: #f9fafb;
            --surface: #ffffff;
            --text: #111827;
            --text-light: #6b7280;
            --border: #e5e7eb;
            --shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1);
            --radius: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Admin Login */
        .admin-login {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .login-card {
            background: var(--surface);
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            padding: 40px;
            width: 100%;
            max-width: 400px;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text);
        }

        .login-subtitle {
            color: var(--text-light);
            font-size: 14px;
        }

        /* Admin Panel */
        .admin-panel {
            display: none;
        }

        /* Header */
        .admin-header {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow);
        }

        .admin-header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 70px;
        }

        .admin-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
            font-weight: 700;
            color: var(--text);
        }

        .admin-nav {
            display: flex;
            gap: 5px;
        }

        .admin-nav-btn {
            padding: 10px 20px;
            background: transparent;
            border: none;
            border-radius: 6px;
            color: var(--text-light);
            cursor: pointer;
            font-family: inherit;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .admin-nav-btn:hover {
            background: var(--background);
            color: var(--text);
        }

        .admin-nav-btn.active {
            background: var(--primary);
            color: white;
        }

        .admin-logout-btn {
            padding: 10px 20px;
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .admin-logout-btn:hover {
            background: #dc2626;
        }

        /* Content */
        .admin-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Section */
        .admin-section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .admin-section.active {
            display: block;
        }

        .section-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 25px;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: transform 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .stat-label {
            color: var(--text-light);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Forms */
        .form-container {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-family: inherit;
            font-size: 14px;
            background: var(--surface);
            color: var(--text);
            transition: border-color 0.2s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-control[type="file"] {
            padding: 10px;
            cursor: pointer;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            user-select: none;
        }

        .form-checkbox input {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 500;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--background);
            border-color: var(--text-light);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        /* Table */
        .table-wrapper {
            background: var(--surface);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th,
        .table td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .table th {
            background: var(--background);
            font-weight: 600;
            color: var(--text);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .table tr:hover {
            background: var(--background);
        }

        .table-actions {
            display: flex;
            gap: 8px;
        }

        /* Messages */
        .message {
            padding: 15px 20px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }

        .message-error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }

        .message-info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #bfdbfe;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-light);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Image Selection */
        .image-section {
            background: var(--background);
            border-radius: var(--radius);
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid var(--border);
        }

        .image-section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text);
        }

        .image-url-input {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .image-url-input .form-control {
            flex: 1;
        }

        .file-upload {
            position: relative;
            margin-bottom: 20px;
        }

        .file-upload-label {
            display: block;
            padding: 40px;
            border: 2px dashed var(--border);
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.2s;
        }

        .file-upload-label:hover {
            border-color: var(--primary);
        }

        .file-upload-label span {
            display: block;
            color: var(--text-light);
            margin-bottom: 10px;
        }

        .file-upload input[type="file"] {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            opacity: 0;
            cursor: pointer;
        }

        .image-preview {
            margin-top: 20px;
            text-align: center;
        }

        .image-preview img {
            max-width: 200px;
            max-height: 150px;
            border-radius: 6px;
            border: 1px solid var(--border);
        }

        /* Image Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--surface);
            border-radius: var(--radius);
            width: 100%;
            max-width: 900px;
            max-height: 80vh;
            overflow: hidden;
            animation: modalSlideUp 0.3s ease;
        }

        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-size: 20px;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
            line-height: 1;
        }

        .modal-body {
            padding: 20px;
            overflow-y: auto;
            max-height: calc(80vh - 100px);
        }

        .images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .image-item {
            border: 1px solid var(--border);
            border-radius: 6px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.2s;
        }

        .image-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .image-item.selected {
            border-color: var(--primary);
            border-width: 2px;
        }

        .image-item img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }

        .image-item-name {
            padding: 10px;
            font-size: 12px;
            color: var(--text-light);
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            background: var(--background);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .admin-header-content {
                flex-direction: column;
                height: auto;
                padding: 15px;
            }

            .admin-nav {
                flex-wrap: wrap;
                justify-content: center;
                margin: 10px 0;
            }

            .admin-nav-btn {
                padding: 8px 15px;
                font-size: 13px;
            }

            .admin-logout-btn {
                margin-top: 10px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .table-wrapper {
                overflow-x: auto;
            }

            .table {
                min-width: 600px;
            }

            .btn-group {
                flex-direction: column;
            }

            .btn-group .btn {
                width: 100%;
            }

            .images-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
        }

        @media (max-width: 480px) {
            .login-card {
                padding: 30px 20px;
            }

            .form-container {
                padding: 20px;
            }

            .modal-content {
                padding: 15px;
            }

            .images-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
        }

        /* Instructions */
        .instructions {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .instruction-item {
            margin-bottom: 25px;
        }

        .instruction-item:last-child {
            margin-bottom: 0;
        }

        .instruction-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .instruction-list {
            list-style: none;
            padding-left: 0;
        }

        .instruction-list li {
            margin-bottom: 10px;
            padding-left: 25px;
            position: relative;
            color: var(--text-light);
        }

        .instruction-list li:before {
            content: "‚úì";
            color: var(--success);
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .instruction-list ul {
            margin-top: 10px;
            margin-left: 20px;
            padding-left: 20px;
            border-left: 1px solid var(--border);
        }

        code {
            background: var(--background);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: var(--primary);
        }
                /* –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
        .modal {
            display: none !important; /* –í–∞–∂–Ω–æ: —Å–∫—Ä—ã–≤–∞—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex !important; /* –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω–æ */
        }

        /* –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –≤–∏–¥–Ω–∞ */
        .admin-panel {
            display: none;
        }

        .admin-panel[style*="display: block"],
        .admin-panel.show {
            display: block !important;
        }

        /* –î–µ–±–∞–≥ —Å—Ç–∏–ª–∏ - –¥–æ–±–∞–≤—å—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ */
        .debug-border {
            border: 2px solid red !important;
        }

        .debug-bg {
            background: rgba(255, 0, 0, 0.1) !important;
        }
    </style>
</head>
<body>
    <!-- Admin Login -->
    <div class="admin-login" id="adminLogin">
        <div class="login-card">
            <div class="login-header">
                <h1 class="login-title">üõ†Ô∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
                <p class="login-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–º Scooter Parts</p>
            </div>

            <div id="loginMessages"></div>

            <form id="adminLoginForm">
                <div class="form-group">
                    <label class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" class="form-control" name="username" value="admin" required readonly>
                </div>
                <div class="form-group">
                    <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" class="form-control" name="password" required placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    üîê –í–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É
                </button>
            </form>

            <div style="margin-top: 20px; text-align: center;">
                <a href="/" style="color: var(--text-light); text-decoration: none; font-size: 14px;">
                    ‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é
                </a>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <!-- Header -->
        <header class="admin-header">
            <div class="admin-header-content">
                <div class="admin-logo">
                    <span>üõ†Ô∏è</span>
                    <span>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Scooter Parts</span>
                </div>

                <div style="display: flex; align-items: center; gap: 20px;">
                    <nav class="admin-nav">
                        <button class="admin-nav-btn active" data-section="stats">
                            <span>üìä</span>
                            <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                        </button>
                        <button class="admin-nav-btn" data-section="products">
                            <span>üì¶</span>
                            <span>–¢–æ–≤–∞—Ä—ã</span>
                        </button>
                        <button class="admin-nav-btn" data-section="add-product">
                            <span>‚ûï</span>
                            <span>–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</span>
                        </button>
                        <button class="admin-nav-btn" data-section="instructions">
                            <span>‚ÑπÔ∏è</span>
                            <span>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</span>
                        </button>
                            <a href="/admin/add-product" class="admin-nav-btn">
                            <span>‚ûï</span>
                            <span>–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä (–æ—Ç–¥–µ–ª—å–Ω–æ)</span>
                        </a>
                    </nav>

                    <button class="admin-logout-btn" id="adminLogoutBtn">
                        <span>üö™</span>
                        <span>–í—ã–π—Ç–∏</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Content -->
        <main class="admin-content">
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="admin-section active" id="statsSection">
                <h2 class="section-title">üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>

                <div class="stats-grid" id="statsGrid">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</p>
                    </div>
                </div>

                <div class="table-wrapper">
                    <h3 style="padding: 20px; border-bottom: 1px solid var(--border); margin: 0;">üì¶ –¢–æ–≤–∞—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
                    <table class="table" id="categoriesTable">
                        <thead>
                            <tr>
                                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤</th>
                                <th>–í –Ω–∞–ª–∏—á–∏–∏</th>
                                <th>–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ -->
            <div class="admin-section" id="productsSection">
                <h2 class="section-title">üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h2>

                <div class="table-wrapper">
                    <table class="table" id="productsTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                <th>–¶–µ–Ω–∞</th>
                                <th>–ù–∞–ª–∏—á–∏–µ</th>
                                <th>–ü–æ–ø—É–ª—è—Ä–Ω—ã–π</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="7" class="loading">
                                    <div class="loading-spinner"></div>
                                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ -->
            <div class="admin-section" id="addProductSection">
                <h2 class="section-title">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h2>

                <div id="addProductMessages"></div>

                <div class="form-container">
                    <form id="addProductForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *</label>
                                <input type="text" class="form-control" name="name" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä Premium 36V" minlength="3">
                                <small style="color: var(--text-light); font-size: 12px; margin-top: 5px;">–ú–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞</small>
                            </div>
                            <div class="form-group">
                                <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                                <select class="form-control" name="category" required>
                                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é --</option>
                                    <option value="batteries">üîã –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã</option>
                                    <option value="motors">‚öôÔ∏è –ú–æ—Ç–æ—Ä—ã</option>
                                    <option value="electronics">üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</option>
                                    <option value="brakes">üõë –¢–æ—Ä–º–æ–∑–∞</option>
                                    <option value="tires">üõû –ö–æ–ª—ë—Å–∞</option>
                                    <option value="accessories">üîß –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">–¶–µ–Ω–∞ (—Ä—É–±) *</label>
                                <input type="number" class="form-control" name="price" min="0" step="0.01" required placeholder="0.00">
                                <small style="color: var(--text-light); font-size: 12px; margin-top: 5px;">–î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ 0</small>
                            </div>
                            <div class="form-group">
                                <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ *</label>
                                <input type="number" class="form-control" name="stock" min="0" required placeholder="0">
                                <small style="color: var(--text-light); font-size: 12px; margin-top: 5px;">0 –∏–ª–∏ –±–æ–ª—å—à–µ</small>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ *</label>
                            <textarea class="form-control form-textarea" name="description" required placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞..." minlength="10"></textarea>
                            <small style="color: var(--text-light); font-size: 12px; margin-top: 5px;">–ú–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤</small>
                        </div>

                        <!-- –í—ã–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
                        <div class="image-section">
                            <h3 class="image-section-title">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3>

                            <div class="form-group">
                                <label class="form-label">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å)</label>
                                <div class="image-url-input">
                                    <input type="text" class="form-control" id="imageUrlInput" placeholder="https://example.com/image.jpg">
                                    <button type="button" class="btn btn-secondary" id="browseImagesBtn">
                                        üìÅ –í—ã–±—Ä–∞—Ç—å –∏–∑ –≥–∞–ª–µ—Ä–µ–∏
                                    </button>
                                </div>
                                <small style="color: var(--text-light); font-size: 12px; margin-top: 5px;">–ò–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</small>
                            </div>

                            <div class="form-group">
                                <label class="form-label">–ò–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª</label>
                                <div class="file-upload">
                                    <label class="file-upload-label">
                                        <span>üì§ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span>
                                        <span style="font-size: 12px;">JPG, PNG, GIF, WebP (–º–∞–∫—Å. 5MB)</span>
                                    </label>
                                    <input type="file" id="imageFileInput" accept=".jpg,.jpeg,.png,.gif,.webp">
                                </div>
                            </div>

                            <div class="image-preview" id="imagePreview" style="display: none;">
                                <p style="margin-bottom: 10px; color: var(--text-light); font-size: 14px;">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</p>
                                <img id="previewImage" src="" alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-checkbox">
                                <input type="checkbox" name="featured">
                                <span>–û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π —Ç–æ–≤–∞—Ä (–±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω –Ω–∞ –≥–ª–∞–≤–Ω–æ–π)</span>
                            </label>
                        </div>

                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary" id="submitProductBtn">
                                üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä
                            </button>
                            <button type="button" class="btn btn-secondary" id="resetFormBtn">
                                ‚Ü∫ –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
            <div class="admin-section" id="instructionsSection">
                <h2 class="section-title">‚ÑπÔ∏è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –∞–¥–º–∏–Ω–∫–æ–π</h2>

                <div class="instructions">
                    <div class="instruction-item">
                        <h3 class="instruction-title">üì¶ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤</h3>
                        <ul class="instruction-list">
                            <li>–í—Å–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è (–æ—Ç–º–µ—á–µ–Ω—ã *)</li>
                            <li>–¶–µ–Ω–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ä—É–±–ª—è—Ö, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ—Å—è—Ç–∏—á–Ω—ã–µ –¥—Ä–æ–±–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 1499.99)</li>
                            <li>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ü–µ–ª—ã–º —á–∏—Å–ª–æ–º (0 –∏–ª–∏ –±–æ–ª—å—à–µ)</li>
                            <li>–î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–æ–∂–Ω–æ:
                                <ul>
                                    <li>–í–≤–µ—Å—Ç–∏ URL —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</li>
                                    <li>–í—ã–±—Ä–∞—Ç—å –∏–∑ –∏–º–µ—é—â–∏—Ö—Å—è –≤ –≥–∞–ª–µ—Ä–µ–µ (–∫–Ω–æ–ø–∫–∞ "–í—ã–±—Ä–∞—Ç—å")</li>
                                    <li>–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</li>
                                    <li>–û—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º - –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <div class="instruction-item">
                        <h3 class="instruction-title">üñºÔ∏è –†–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</h3>
                        <ul class="instruction-list">
                            <li>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: JPG, PNG, GIF, WebP</li>
                            <li>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 5MB</li>
                            <li>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ: 800x600 –ø–∏–∫—Å–µ–ª–µ–π</li>
                            <li>–í—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ /static/uploads/</li>
                        </ul>
                    </div>

                    <div class="instruction-item">
                        <h3 class="instruction-title">üîß –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤</h3>
                        <ul class="instruction-list">
                            <li>–î–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –≤ —Ç–∞–±–ª–∏—Ü–µ —Ç–æ–≤–∞—Ä–æ–≤</li>
                            <li>–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª—é–±—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–µ</li>
                            <li>–î–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä" –≤ —Ñ–æ—Ä–º–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</li>
                            <li>–£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!</li>
                        </ul>
                    </div>

                    <div class="instruction-item">
                        <h3 class="instruction-title">‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        <ul class="instruction-list">
                            <li>–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ PostgreSQL –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö</li>
                            <li>–ê–¥–º–∏–Ω—Å–∫–∏–π –ª–æ–≥–∏–Ω: admin (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)</li>
                            <li>–ü–∞—Ä–æ–ª—å –∑–∞–¥–∞–µ—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è ADMIN_PASSWORD</li>
                            <li>–î–ª—è —Å–º–µ–Ω—ã –∏–∫–æ–Ω–∫–∏ —Å–∞–π—Ç–∞ –∑–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ /static/favicon/</li>
                        </ul>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
    <div class="modal" id="imageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìÅ –í—ã–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h2>
                <button class="modal-close" id="closeImageModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="imageModalMessages"></div>

                <div style="margin-bottom: 20px; display: flex; gap: 10px;">
                    <button class="btn btn-secondary" id="refreshImagesBtn">
                        üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
                    </button>
                    <button class="btn btn-primary" id="uploadNewImageBtn">
                        ‚¨ÜÔ∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤–æ–µ
                    </button>
                </div>

                <div class="images-grid" id="imagesGrid">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...</p>
                    </div>
                </div>

                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn btn-success" id="selectImageBtn" style="display: none; margin-bottom: 10px;">
                        ‚úÖ –í—ã–±—Ä–∞—Ç—å —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                    </button>
                    <button class="btn btn-secondary" id="cancelImageSelectBtn">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
    <div class="modal" id="uploadImageModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>‚¨ÜÔ∏è –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h2>
                <button class="modal-close" id="closeUploadModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="uploadImageMessages"></div>

                <form id="uploadImageForm">
                    <div class="form-group">
                        <label class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                        <div class="file-upload">
                            <label class="file-upload-label">
                                <span>üì§ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞</span>
                                <span style="font-size: 12px;">JPG, PNG, GIF, WebP (–º–∞–∫—Å. 5MB)</span>
                            </label>
                            <input type="file" id="newImageFileInput" accept=".jpg,.jpeg,.png,.gif,.webp" required>
                        </div>
                    </div>

                    <div class="image-preview" id="uploadPreview" style="display: none;">
                        <p style="margin-bottom: 10px; color: var(--text-light); font-size: 14px;">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</p>
                        <img id="uploadPreviewImage" src="" alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä">
                    </div>

                    <div class="btn-group" style="margin-top: 20px;">
                        <button type="submit" class="btn btn-success">
                            ‚¨ÜÔ∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                        </button>
                        <button type="button" class="btn btn-secondary" id="cancelUploadBtn">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
    <div class="modal" id="editProductModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä</h2>
                <button class="modal-close" id="closeEditModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="editProductMessages"></div>

                <form id="editProductForm">
                    <input type="hidden" name="id" id="editProductId">

                    <div class="form-group">
                        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *</label>
                        <input type="text" class="form-control" name="name" id="editProductName" required minlength="3">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                            <select class="form-control" name="category" id="editProductCategory" required>
                                <option value="batteries">üîã –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã</option>
                                <option value="motors">‚öôÔ∏è –ú–æ—Ç–æ—Ä—ã</option>
                                <option value="electronics">üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</option>
                                <option value="brakes">üõë –¢–æ—Ä–º–æ–∑–∞</option>
                                <option value="tires">üõû –ö–æ–ª—ë—Å–∞</option>
                                <option value="accessories">üîß –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">–¶–µ–Ω–∞ (—Ä—É–±) *</label>
                            <input type="number" class="form-control" name="price" id="editProductPrice" min="0" step="0.01" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ *</label>
                        <input type="number" class="form-control" name="stock" id="editProductStock" min="0" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ *</label>
                        <textarea class="form-control form-textarea" name="description" id="editProductDescription" required minlength="10"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                        <input type="text" class="form-control" name="image_url" id="editProductImageUrl" placeholder="/static/images/product_default.jpg">
                        <small style="color: var(--text-light); font-size: 12px; margin-top: 5px;">–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</small>
                    </div>

                    <div class="form-group">
                        <label class="form-checkbox">
                            <input type="checkbox" name="featured" id="editProductFeatured">
                            <span>–ü–æ–ø—É–ª—è—Ä–Ω—ã–π —Ç–æ–≤–∞—Ä</span>
                        </label>
                    </div>

                    <div class="btn-group">
                        <button type="submit" class="btn btn-success">
                            üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                        </button>
                        <button type="button" class="btn btn-danger" id="deleteProductBtn">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä
                        </button>
                        <button type="button" class="btn btn-secondary" id="cancelEditBtn">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∫–∏
        let adminToken = null;
        let currentProducts = [];
        let editingProductId = null;
        let availableImages = [];
        let selectedModalImage = null;

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const adminLogin = document.getElementById('adminLogin');
        const adminPanel = document.getElementById('adminPanel');
        const adminLoginForm = document.getElementById('adminLoginForm');
        const loginMessages = document.getElementById('loginMessages');
        const adminLogoutBtn = document.getElementById('adminLogoutBtn');
        const adminNavBtns = document.querySelectorAll('.admin-nav-btn');
        const adminSections = document.querySelectorAll('.admin-section');

        // –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
        const addProductForm = document.getElementById('addProductForm');
        const addProductMessages = document.getElementById('addProductMessages');
        const submitProductBtn = document.getElementById('submitProductBtn');
        const resetFormBtn = document.getElementById('resetFormBtn');
        const imageUrlInput = document.getElementById('imageUrlInput');
        const browseImagesBtn = document.getElementById('browseImagesBtn');
        const imageFileInput = document.getElementById('imageFileInput');
        const imagePreview = document.getElementById('imagePreview');
        const previewImage = document.getElementById('previewImage');

        // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
        const imageModal = document.getElementById('imageModal');
        const uploadImageModal = document.getElementById('uploadImageModal');
        const editProductModal = document.getElementById('editProductModal');
        const closeImageModal = document.getElementById('closeImageModal');
        const closeUploadModal = document.getElementById('closeUploadModal');
        const closeEditModal = document.getElementById('closeEditModal');

        // –§—É–Ω–∫—Ü–∏–∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        function showModal(modal) {
            modal.classList.add('active');
        }

        function hideModal(modal) {
            modal.classList.remove('active');
        }

        function showMessage(type, text, container) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message message-${type}`;
            messageDiv.innerHTML = `
                <span>${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è'}</span>
                <span>${text}</span>
            `;

            // –í—Å—Ç–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
            if (container.firstChild) {
                container.insertBefore(messageDiv, container.firstChild);
            } else {
                container.appendChild(messageDiv);
            }

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.remove();
                }
            }, 5000);
        }

        function clearMessages(container) {
            container.innerHTML = '';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∫–∏...');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–¥–º–∏–Ω—Å–∫–∏–π —Ç–æ–∫–µ–Ω
            const token = localStorage.getItem('adminToken');
            if (token) {
                console.log('üîë –¢–æ–∫–µ–Ω –Ω–∞–π–¥–µ–Ω –≤ localStorage');
                checkAdminAuth(token);
            } else {
                console.log('‚ùå –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞');
            }

            // –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∫—É
            adminLoginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                clearMessages(loginMessages);

                const formData = new FormData(adminLoginForm);
                const data = Object.fromEntries(formData);

                console.log('üîê –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∫—É:', data.username);

                try {
                    const response = await fetch('/api/admin/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });

                    console.log('üì• –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', response.status);

                    if (response.ok) {
                        const result = await response.json();
                        adminToken = result.access_token;
                        localStorage.setItem('adminToken', adminToken);

                        console.log('‚úÖ –í—Ö–æ–¥ —É—Å–ø–µ—à–µ–Ω, —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω');

                        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –∞–¥–º–∏–Ω–∫—É
                        adminLogin.style.display = 'none';
                        adminPanel.style.display = 'block';

                        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                        loadAdminStats();
                        loadProductsForAdmin();

                        showMessage('success', '–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!', loginMessages);
                    } else {
                        const error = await response.json();
                        console.error('‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
                        showMessage('error', error.detail || '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞', loginMessages);
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –≤—Ö–æ–¥–µ:', error);
                    showMessage('error', '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.', loginMessages);
                }
            });

            // –í—ã—Ö–æ–¥ –∏–∑ –∞–¥–º–∏–Ω–∫–∏
            adminLogoutBtn.addEventListener('click', () => {
                console.log('üö™ –í—ã—Ö–æ–¥ –∏–∑ –∞–¥–º–∏–Ω–∫–∏');
                localStorage.removeItem('adminToken');
                adminToken = null;
                adminPanel.style.display = 'none';
                adminLogin.style.display = 'flex';
                adminLoginForm.reset();
                clearMessages(loginMessages);
            });

            // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∞–¥–º–∏–Ω–∫–µ
            adminNavBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                    adminNavBtns.forEach(b => b.classList.remove('active'));
                    // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ–∫—É—â–µ–π –∫–Ω–æ–ø–∫–µ
                    btn.classList.add('active');

                    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
                    adminSections.forEach(section => section.classList.remove('active'));

                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å–µ–∫—Ü–∏—é
                    const section = btn.dataset.section;
                    document.getElementById(`${section}Section`).classList.add('active');
                });
            });

            // –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
            addProductForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                clearMessages(addProductMessages);
                
                console.log('üì§ –ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞...');

                // –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
                const name = document.querySelector('[name="name"]').value.trim();
                const category = document.querySelector('[name="category"]').value;
                const price = document.querySelector('[name="price"]').value;
                const description = document.querySelector('[name="description"]').value.trim();
                const stock = document.querySelector('[name="stock"]').value;
                const featured = document.querySelector('[name="featured"]').checked;

                console.log('üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã:');
                console.log('  –ù–∞–∑–≤–∞–Ω–∏–µ:', name, '(–¥–ª–∏–Ω–∞:', name.length, ')');
                console.log('  –ö–∞—Ç–µ–≥–æ—Ä–∏—è:', category);
                console.log('  –¶–µ–Ω–∞:', price);
                console.log('  –û–ø–∏—Å–∞–Ω–∏–µ:', description.substring(0, 50) + '...', '(–¥–ª–∏–Ω–∞:', description.length, ')');
                console.log('  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:', stock);
                console.log('  –ü–æ–ø—É–ª—è—Ä–Ω—ã–π:', featured);

                if (!name || name.length < 3) {
                    showMessage('error', '–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞', addProductMessages);
                    return;
                }

                if (!category) {
                    showMessage('error', '–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Ç–æ–≤–∞—Ä–∞', addProductMessages);
                    return;
                }

                if (!price || parseFloat(price) <= 0) {
                    showMessage('error', '–¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ 0', addProductMessages);
                    return;
                }

                if (!description || description.length < 10) {
                    showMessage('error', '–û–ø–∏—Å–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤', addProductMessages);
                    return;
                }

                if (!stock || parseInt(stock) < 0) {
                    showMessage('error', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 0 –∏–ª–∏ –±–æ–ª—å—à–µ', addProductMessages);
                    return;
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–∫–µ–Ω
                if (!adminToken) {
                    showMessage('error', '–¢–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω. –í–æ–π–¥–∏—Ç–µ –∑–∞–Ω–æ–≤–æ.', addProductMessages);
                    adminLogin.style.display = 'flex';
                    adminPanel.style.display = 'none';
                    return;
                }

                // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º FormData –ö–û–†–†–ï–ö–¢–ù–û
                const formData = new FormData();
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è
                formData.append('name', name);
                formData.append('category', category);
                formData.append('price', price);
                formData.append('description', description);
                formData.append('stock', stock);
                formData.append('featured', featured.toString());

                // –î–æ–±–∞–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                const imageUrl = imageUrlInput.value.trim();
                const imageFile = imageFileInput.files[0];

                if (imageFile) {
                    console.log('üìÅ –î–æ–±–∞–≤–ª–µ–Ω —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', imageFile.name, '—Ä–∞–∑–º–µ—Ä:', imageFile.size);
                    formData.append('image_file', imageFile);
                } else if (imageUrl) {
                    console.log('üîó –î–æ–±–∞–≤–ª–µ–Ω URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', imageUrl);
                    formData.append('image_url', imageUrl);
                }

                // –û—Ç–ª–∞–¥–æ—á–Ω—ã–π –≤—ã–≤–æ–¥ FormData
                console.log('üìã –°–æ–¥–µ—Ä–∂–∏–º–æ–µ FormData:');
                for (let [key, value] of formData.entries()) {
                    console.log(`  ${key}:`, value instanceof File ? `[–§–∞–π–ª: ${value.name}]` : value);
                }

                // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏
                submitProductBtn.disabled = true;
                submitProductBtn.innerHTML = '‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞...';

                try {
                    console.log('üöÄ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ /api/admin/products...');
                    
                    const response = await fetch('/api/admin/products', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${adminToken}`
                            // –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º 'Content-Type' - –±—Ä–∞—É–∑–µ—Ä —Å–∞–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–ª—è FormData
                        },
                        body: formData
                    });

                    console.log('üì• –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç. –°—Ç–∞—Ç—É—Å:', response.status, response.statusText);

                    if (response.ok) {
                        const result = await response.json();
                        console.log('‚úÖ –£—Å–ø–µ—Ö! –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', result);
                        showMessage('success', '–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!', addProductMessages);

                        // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
                        addProductForm.reset();
                        imageFileInput.value = '';
                        imageUrlInput.value = '';
                        imagePreview.style.display = 'none';

                        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
                        setTimeout(() => {
                            loadProductsForAdmin();
                            loadAdminStats();

                            // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≤–∫–ª–∞–¥–∫—É —Ç–æ–≤–∞—Ä–æ–≤
                            adminNavBtns.forEach(b => b.classList.remove('active'));
                            document.querySelector('[data-section="products"]').classList.add('active');
                            adminSections.forEach(s => s.classList.remove('active'));
                            document.getElementById('productsSection').classList.add('active');
                        }, 1500);

                    } else {
                        const errorText = await response.text();
                        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞. –°—Ç–∞—Ç—É—Å:', response.status, '–¢–µ–∫—Å—Ç:', errorText);
                        
                        let errorMessage = '–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞';
                        try {
                            const errorJson = JSON.parse(errorText);
                            errorMessage = errorJson.detail || errorJson.message || errorMessage;
                        } catch (e) {
                            // –ù–µ JSON –æ—Ç–≤–µ—Ç
                            if (errorText.includes('detail')) {
                                const match = errorText.match(/"detail"\s*:\s*"([^"]+)"/);
                                if (match) {
                                    errorMessage = match[1];
                                }
                            }
                        }
                        
                        showMessage('error', errorMessage, addProductMessages);
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
                        if (response.status === 401 || response.status === 403) {
                            console.warn('‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞...');
                            setTimeout(() => {
                                localStorage.removeItem('adminToken');
                                adminPanel.style.display = 'none';
                                adminLogin.style.display = 'flex';
                                showMessage('error', '–°–µ—Å—Å–∏—è –∏—Å—Ç–µ–∫–ª–∞. –í–æ–π–¥–∏—Ç–µ –∑–∞–Ω–æ–≤–æ.', loginMessages);
                            }, 2000);
                        }
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏:', error);
                    showMessage('error', `–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.`, addProductMessages);
                } finally {
                    // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
                    submitProductBtn.disabled = false;
                    submitProductBtn.innerHTML = 'üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä';
                }
            });

            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
            resetFormBtn.addEventListener('click', () => {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É? –í—Å–µ –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.')) {
                    addProductForm.reset();
                    imageFileInput.value = '';
                    imageUrlInput.value = '';
                    imagePreview.style.display = 'none';
                    clearMessages(addProductMessages);
                    showMessage('info', '–§–æ—Ä–º–∞ –æ—á–∏—â–µ–Ω–∞', addProductMessages);
                }
            });

            // –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            imageFileInput.addEventListener('change', function() {
                if (this.files && this.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        previewImage.src = e.target.result;
                        imagePreview.style.display = 'block';
                    };
                    reader.readAsDataURL(this.files[0]);

                    // –û—á–∏—â–∞–µ–º URL –ø–æ–ª–µ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Ñ–∞–π–ª–∞
                    imageUrlInput.value = '';
                } else {
                    imagePreview.style.display = 'none';
                }
            });

            // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—ã–±–æ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            browseImagesBtn.addEventListener('click', () => {
                openImageModal();
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            closeImageModal.addEventListener('click', () => {
                hideModal(imageModal);
            });

            closeUploadModal.addEventListener('click', () => {
                hideModal(uploadImageModal);
            });

            closeEditModal.addEventListener('click', () => {
                hideModal(editProductModal);
            });

            // –ö–ª–∏–∫ –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            [imageModal, uploadImageModal, editProductModal].forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        hideModal(modal);
                    }
                });
            });

            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            setupImageModalHandlers();
        });

        // –§—É–Ω–∫—Ü–∏–∏ –∞–¥–º–∏–Ω–∫–∏
        async function checkAdminAuth(token) {
            try {
                console.log('üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –∞–¥–º–∏–Ω–∞...');
                
                const response = await fetch('/api/admin/stats', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (response.ok) {
                    adminToken = token;
                    adminLogin.style.display = 'none';
                    adminPanel.style.display = 'block';
                    console.log('‚úÖ –¢–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω–∫—É');
                    
                    loadAdminStats();
                    loadProductsForAdmin();
                } else {
                    console.log('‚ùå –¢–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω, —É–¥–∞–ª—è–µ–º –∏–∑ localStorage');
                    localStorage.removeItem('adminToken');
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–¥–º–∏–Ω—Å–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error);
                localStorage.removeItem('adminToken');
            }
        }

        async function loadAdminStats() {
            try {
                console.log('üìä –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...');
                const response = await fetch('/api/admin/stats', {
                    headers: { 'Authorization': `Bearer ${adminToken}` }
                });

                if (response.ok) {
                    const stats = await response.json();
                    displayStats(stats);
                } else if (response.status === 401) {
                    console.log('‚ùå –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏');
                    localStorage.removeItem('adminToken');
                    adminToken = null;
                    adminPanel.style.display = 'none';
                    adminLogin.style.display = 'flex';
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                document.getElementById('statsGrid').innerHTML = '<div class="message message-error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</div>';
            }
        }

        function displayStats(stats) {
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${stats.users.total}</div>
                    <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${stats.products.total}</div>
                    <div class="stat-label">–¢–æ–≤–∞—Ä–æ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${stats.products.in_stock}</div>
                    <div class="stat-label">–¢–æ–≤–∞—Ä–æ–≤ –≤ –Ω–∞–ª–∏—á–∏–∏</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${stats.carts.with_items}</div>
                    <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ—Ä–∑–∏–Ω</div>
                </div>
            `;

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç–¥–µ–ª—å–Ω–æ
            loadCategoriesStats();
        }

        async function loadCategoriesStats() {
            try {
                console.log('üìä –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º...');
                const response = await fetch('/api/categories');
                const data = await response.json();
                const categories = data.categories;

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
                const productsResponse = await fetch('/api/products');
                const allProducts = await productsResponse.json();

                let categoriesHtml = '';

                categories.forEach(category => {
                    const categoryProducts = allProducts.filter(p => p.category === category.id);
                    const inStock = categoryProducts.filter(p => p.stock > 0).length;
                    const outOfStock = categoryProducts.filter(p => p.stock === 0).length;

                    categoriesHtml += `
                        <tr>
                            <td>${category.name}</td>
                            <td>${category.count}</td>
                            <td>${inStock}</td>
                            <td>${outOfStock}</td>
                        </tr>
                    `;
                });

                const tbody = document.querySelector('#categoriesTable tbody');
                tbody.innerHTML = categoriesHtml;

            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:', error);
            }
        }

        async function loadProductsForAdmin() {
            try {
                console.log('üì¶ –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –∞–¥–º–∏–Ω–∫–∏...');
                const response = await fetch('/api/products');
                currentProducts = await response.json();
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${currentProducts.length} —Ç–æ–≤–∞—Ä–æ–≤`);
                displayProductsForAdmin(currentProducts);
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤:', error);
                const tbody = document.querySelector('#productsTable tbody');
                tbody.innerHTML = '<tr><td colspan="7" class="message message-error">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤</td></tr>';
            }
        }

        function displayProductsForAdmin(products) {
            const tbody = document.querySelector('#productsTable tbody');

            if (products.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: var(--text-light);">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td></tr>';
                return;
            }

            tbody.innerHTML = products.map(product => `
                <tr>
                    <td>${product.id}</td>
                    <td><strong>${product.name}</strong></td>
                    <td><span class="badge">${getCategoryName(product.category)}</span></td>
                    <td><strong>${formatPrice(product.price)} ‚ÇΩ</strong></td>
                    <td>
                        <span style="color: ${product.stock > 0 ? 'var(--success)' : 'var(--danger)'}; font-weight: 500;">
                            ${product.stock > 0 ? `${product.stock} —à—Ç.` : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}
                        </span>
                    </td>
                    <td>
                        <span style="color: ${product.featured ? 'var(--success)' : 'var(--text-light)'}">
                            ${product.featured ? '‚úì –î–∞' : '‚úó –ù–µ—Ç'}
                        </span>
                    </td>
                    <td>
                        <div class="table-actions">
                            <button class="btn btn-secondary" onclick="editProduct(${product.id})" style="padding: 6px 12px; font-size: 12px;">
                                ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function editProduct(productId) {
            console.log('‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ ID:', productId);
            const product = currentProducts.find(p => p.id === productId);
            if (!product) {
                console.error('‚ùå –¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω:', productId);
                return;
            }

            editingProductId = productId;

            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞
            document.getElementById('editProductId').value = product.id;
            document.getElementById('editProductName').value = product.name;
            document.getElementById('editProductCategory').value = product.category;
            document.getElementById('editProductPrice').value = product.price;
            document.getElementById('editProductStock').value = product.stock;
            document.getElementById('editProductDescription').value = product.description;
            document.getElementById('editProductImageUrl').value = product.image_url;
            document.getElementById('editProductFeatured').checked = product.featured;

            // –û—á–∏—â–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
            clearMessages(document.getElementById('editProductMessages'));

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            showModal(editProductModal);

            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ñ–æ—Ä–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            setupEditFormHandlers();
        }

       function setupEditFormHandlers() {
            const editProductForm = document.getElementById('editProductForm');
            const editProductMessages = document.getElementById('editProductMessages');
            const deleteProductBtn = document.getElementById('deleteProductBtn');
            const cancelEditBtn = document.getElementById('cancelEditBtn');

            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            const newEditForm = editProductForm.cloneNode(true);
            editProductForm.parentNode.replaceChild(newEditForm, editProductForm);

            const newDeleteBtn = deleteProductBtn.cloneNode(true);
            deleteProductBtn.parentNode.replaceChild(newDeleteBtn, deleteProductBtn);

            const newCancelBtn = cancelEditBtn.cloneNode(true);
            cancelEditBtn.parentNode.replaceChild(newCancelBtn, cancelEditBtn);

            // –ù–∞–∑–Ω–∞—á–∞–µ–º –Ω–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            document.getElementById('editProductForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                clearMessages(editProductMessages);

                if (!editingProductId) {
                    showMessage('error', '–¢–æ–≤–∞—Ä –Ω–µ –≤—ã–±—Ä–∞–Ω –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', editProductMessages);
                    return;
                }

                console.log('üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–∞ ID:', editingProductId);

                const formData = new FormData(document.getElementById('editProductForm'));

                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
                const data = new URLSearchParams();

                if (formData.get('name')) data.append('name', formData.get('name'));
                if (formData.get('category')) data.append('category', formData.get('category'));
                if (formData.get('price')) data.append('price', formData.get('price'));
                if (formData.get('description')) data.append('description', formData.get('description'));
                if (formData.get('stock')) data.append('stock', formData.get('stock'));
                if (formData.get('image_url')) data.append('image_url', formData.get('image_url'));
                data.append('featured', formData.get('featured') === 'on' ? 'true' : 'false');

                try {
                    const response = await fetch(`/api/admin/products/${editingProductId}`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `Bearer ${adminToken}`,
                            'Content-Type': 'application/x-www-form-urlencoded'
                        },
                        body: data
                    });

                    console.log('üì• –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏:', response.status);

                    if (response.ok) {
                        const result = await response.json();
                        console.log('‚úÖ –¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª–µ–Ω:', result);
                        showMessage('success', result.message || '–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω!', editProductMessages);

                        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É
                        setTimeout(() => {
                            hideModal(editProductModal);
                            loadProductsForAdmin();
                            loadAdminStats();
                        }, 1000);
                    } else {
                        const error = await response.json();
                        console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞:', error);
                        showMessage('error', error.detail || '–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞', editProductMessages);
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏:', error);
                    showMessage('error', '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', editProductMessages);
                }
            });

            document.getElementById('deleteProductBtn').addEventListener('click', async () => {
                if (!editingProductId) {
                    showMessage('error', '–¢–æ–≤–∞—Ä –Ω–µ –≤—ã–±—Ä–∞–Ω –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è', editProductMessages);
                    return;
                }

                if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                    return;
                }

                console.log('üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ ID:', editingProductId);

                try {
                    const response = await fetch(`/api/admin/products/${editingProductId}`, {
                        method: 'DELETE',
                        headers: {
                            'Authorization': `Bearer ${adminToken}`
                        }
                    });

                    console.log('üì• –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏:', response.status);

                    if (response.ok) {
                        const result = await response.json();
                        console.log('‚úÖ –¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω:', result);
                        showMessage('success', result.message || '–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!', editProductMessages);

                        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É
                        setTimeout(() => {
                            hideModal(editProductModal);
                            loadProductsForAdmin();
                            loadAdminStats();
                        }, 1000);
                    } else {
                        const error = await response.json();
                        console.error('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞:', error);
                        showMessage('error', error.detail || '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞', editProductMessages);
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏:', error);
                    showMessage('error', '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', editProductMessages);
                }
            });

            document.getElementById('cancelEditBtn').addEventListener('click', () => {
                console.log('‚ùå –û—Ç–º–µ–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞');
                hideModal(editProductModal);
            });
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
        function openImageModal() {
            console.log('üñºÔ∏è –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—ã–±–æ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π');
            showModal(imageModal);
            loadAvailableImages();
        }

        function setupImageModalHandlers() {
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            document.getElementById('refreshImagesBtn').addEventListener('click', () => {
                console.log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π');
                loadAvailableImages();
            });

            // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            document.getElementById('uploadNewImageBtn').addEventListener('click', () => {
                console.log('‚¨ÜÔ∏è –û—Ç–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
                hideModal(imageModal);
                showModal(uploadImageModal);
            });

            // –í—ã–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            document.getElementById('selectImageBtn').addEventListener('click', () => {
                if (selectedModalImage) {
                    console.log('‚úÖ –í—ã–±—Ä–∞–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:', selectedModalImage);
                    imageUrlInput.value = selectedModalImage;
                    hideModal(imageModal);
                }
            });

            // –û—Ç–º–µ–Ω–∞ –≤—ã–±–æ—Ä–∞
            document.getElementById('cancelImageSelectBtn').addEventListener('click', () => {
                console.log('‚ùå –û—Ç–º–µ–Ω–∞ –≤—ã–±–æ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
                hideModal(imageModal);
            });

            // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            document.getElementById('uploadImageForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const messagesContainer = document.getElementById('uploadImageMessages');
                clearMessages(messagesContainer);

                const fileInput = document.getElementById('newImageFileInput');
                if (!fileInput.files || !fileInput.files[0]) {
                    showMessage('error', '–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏', messagesContainer);
                    return;
                }

                const file = fileInput.files[0];
                console.log('‚¨ÜÔ∏è –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞:', file.name, '—Ä–∞–∑–º–µ—Ä:', file.size);

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–º–∞–∫—Å 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    showMessage('error', '–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 5MB', messagesContainer);
                    return;
                }

                const formData = new FormData();
                formData.append('image_file', file);

                try {
                    const response = await fetch('/api/admin/upload-image', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${adminToken}`
                        },
                        body: formData
                    });

                    console.log('üì• –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:', response.status);

                    if (response.ok) {
                        const result = await response.json();
                        console.log('‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ:', result);
                        showMessage('success', '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!', messagesContainer);

                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
                        loadAvailableImages();

                        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É
                        setTimeout(() => {
                            hideModal(uploadImageModal);
                            showModal(imageModal);
                            fileInput.value = '';
                            document.getElementById('uploadPreview').style.display = 'none';
                        }, 1000);
                    } else {
                        const error = await response.json();
                        console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', error);
                        showMessage('error', error.detail || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è', messagesContainer);
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:', error);
                    showMessage('error', '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', messagesContainer);
                }
            });

            // –û—Ç–º–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏
            document.getElementById('cancelUploadBtn').addEventListener('click', () => {
                console.log('‚ùå –û—Ç–º–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
                hideModal(uploadImageModal);
                showModal(imageModal);
            });

            // –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–≥—Ä—É–∂–∞–µ–º–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            document.getElementById('newImageFileInput').addEventListener('change', function() {
                const preview = document.getElementById('uploadPreview');
                const previewImage = document.getElementById('uploadPreviewImage');

                if (this.files && this.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        previewImage.src = e.target.result;
                        preview.style.display = 'block';
                    };
                    reader.readAsDataURL(this.files[0]);
                } else {
                    preview.style.display = 'none';
                }
            });
        }

        async function loadAvailableImages() {
            try {
                console.log('üñºÔ∏è –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...');
                const response = await fetch('/api/admin/images', {
                    headers: { 'Authorization': `Bearer ${adminToken}` }
                });

                if (response.ok) {
                    const data = await response.json();
                    availableImages = data.images;
                    console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${availableImages.length} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π`);
                    displayAvailableImages();
                } else {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:', response.status);
                    showMessage('error', '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π', document.getElementById('imageModalMessages'));
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:', error);
                showMessage('error', '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', document.getElementById('imageModalMessages'));
            }
        }

        function displayAvailableImages() {
            const imagesGrid = document.getElementById('imagesGrid');
            const selectImageBtn = document.getElementById('selectImageBtn');

            if (availableImages.length === 0) {
                imagesGrid.innerHTML = '<div class="message message-info">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</div>';
                selectImageBtn.style.display = 'none';
                return;
            }

            imagesGrid.innerHTML = availableImages.map(image => `
                <div class="image-item ${selectedModalImage === image.url ? 'selected' : ''}" 
                     onclick="selectImage('${image.url}')">
                    <img src="${image.url}" alt="${image.name}" onerror="this.src='/static/images/product_default.jpg'">
                    <div class="image-item-name">${image.name}</div>
                </div>
            `).join('');

            selectImageBtn.style.display = selectedModalImage ? 'inline-block' : 'none';
        }

        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        window.selectImage = function(imageUrl) {
            console.log('üñºÔ∏è –í—ã–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', imageUrl);
            selectedModalImage = imageUrl;

            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
            document.querySelectorAll('.image-item').forEach(item => {
                item.classList.remove('selected');
                if (item.onclick && item.onclick.toString().includes(imageUrl)) {
                    item.classList.add('selected');
                }
            });

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤—ã–±–æ—Ä–∞
            document.getElementById('selectImageBtn').style.display = 'inline-block';
        };

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getCategoryName(categoryId) {
            const names = {
                'batteries': '–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã',
                'motors': '–ú–æ—Ç–æ—Ä—ã',
                'electronics': '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞',
                'brakes': '–¢–æ—Ä–º–æ–∑–∞',
                'tires': '–ö–æ–ª—ë—Å–∞',
                'accessories': '–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã'
            };
            return names[categoryId] || categoryId;
        }

        function formatPrice(price) {
            return new Intl.NumberFormat('ru-RU').format(price);
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        window.editProduct = editProduct;
        window.selectImage = selectImage;
    </script>
</body>
</html>